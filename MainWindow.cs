using System;
using System.IO;
using System.Collections.Generic;
using System.ComponentModel;
using System.Data;
using System.Drawing;
using System.Linq;
using System.Text;
using System.Threading.Tasks;
using System.Windows.Forms;
using Memory;
using System.Threading;
using System.Net.Http;
using Newtonsoft.Json.Linq;

namespace Xbox_Achievement_Unlocker
{
    public partial class MainWindow : Form
    {
        public Mem m = new Mem();
        bool attached = false;
        public MainWindow()
        {
            InitializeComponent();
        }

        private void BGWorker_DoWork(object sender, DoWorkEventArgs e)
        {
            while(true)
            {
                if (!m.OpenProcess("XboxAppServices"))
                {
                    attached = false;
                    Thread.Sleep(1000);
                    continue;
                }
                attached = true;
                Thread.Sleep(1000);
                BGWorker.ReportProgress(0);
            }
        }

        private void MainWindow_Shown(object sender, EventArgs e)
        {
            BGWorker.RunWorkerAsync();
        }

        private void BGWorker_ProgressChanged(object sender, ProgressChangedEventArgs e)
        {
            if (attached)
            {
                LBL_Attached.Text = "Attached to: XboxAppServices.exe (" + m.GetProcIdFromName("XboxAppServices").ToString() + ")";
                LBL_Attached.ForeColor = Color.Green;
            }
            if (!attached)
            {
                LBL_Attached.Text = "Not attached to Xbox App";
                LBL_Attached.ForeColor = Color.Red;
            }
        }

        private void BGWorker_RunWorkerCompleted(object sender, RunWorkerCompletedEventArgs e)
        {
            BGWorker.RunWorkerAsync();
        }
        //define some xauth variables
        long XauthStartAddress;
        long XauthEndAddress;
        string XauthStartAddressHex;
        long XauthLength;
        string xauthtoken;
        private async void BTN_GrabXauth_Click(object sender, EventArgs e)
        {
            //scan for first part of xauth "Authorization: XBL3.0 x="
            XauthStartAddress = (await (m.AoBScan("41 75 74 68 6F 72 69 7A 61 74 69 6F 6E 3A 20 58 42 4C 33 2E 30 20 78 3D", true, true))).FirstOrDefault();
            XauthStartAddressHex = (XauthStartAddress + 15).ToString("X");
            //scan for the end of xauth "Content - Length: "
            IEnumerable<long> XauthEndScanList = await m.AoBScan("0D 0A 43 6F 6E 74 65 6E 74 2D 4C 65 6E 67 74 68 3A 20", true, true);
            foreach (var endaddr in XauthEndScanList.ToArray())
            {
                if (endaddr> XauthStartAddress)
                {
                    //find the closest end to the start of xauth to use as length
                    XauthEndAddress = endaddr;
                    XauthLength = (XauthEndAddress - XauthStartAddress-15);
                    break;
                }
            }
            //read the bytes into string
            try
            {
                xauthtoken = Encoding.ASCII.GetString(m.ReadBytes(XauthStartAddressHex, XauthLength));
                TXT_Xauth.Text = "xauth: " + xauthtoken;
            }
            catch
            {
                MessageBox.Show("something with the xauth scan did a fucky wucky");
            }

        }
        HttpClient client = new HttpClient();
        string xuid;
        private async void BTN_XUID_Click(object sender, EventArgs e)
        {
            /*client.DefaultRequestHeaders.Clear();
            client.DefaultRequestHeaders.Add("x-xbl-contract-version", "5");
            client.DefaultRequestHeaders.Add("Accept-Encoding", "gzip, deflate");
            client.DefaultRequestHeaders.Add("accept", "application/json");
            client.DefaultRequestHeaders.Add("accept-language", "en-GB");
            client.DefaultRequestHeaders.Add("Authorization", xauthtoken);
            client.DefaultRequestHeaders.Add("Host", "peoplehub.xboxlive.com");
            client.DefaultRequestHeaders.Add("Connection", "Keep-Alive");
            try
            {
                var responseString = await client.GetStringAsync("https://peoplehub.xboxlive.com/users/me/people/search/decoration/detail,preferredColor?q=" + TXT_Gamertag.Text);
                var Jsonresponse = (dynamic)(new JObject());
                Jsonresponse = (dynamic)JObject.Parse(responseString);
                LBL_XUID.Text = "XUID: " + Jsonresponse.people[0].xuid;
            }*/


            //required headers for a request to go through. (just taken from a legitimate request to profile.xboxlive.com)
            client.DefaultRequestHeaders.Clear();
            client.DefaultRequestHeaders.Add("x-xbl-contract-version", "2");
            client.DefaultRequestHeaders.Add("Accept-Encoding", "gzip, deflate");
            client.DefaultRequestHeaders.Add("accept", "application/json");
            client.DefaultRequestHeaders.Add("accept-language", "en-GB");
            client.DefaultRequestHeaders.Add("Authorization", xauthtoken);
            client.DefaultRequestHeaders.Add("Host", "profile.xboxlive.com");
            client.DefaultRequestHeaders.Add("Connection", "Keep-Alive");
            try
            {
                //query the users own profile using their xauth to find out profile information for future queries
                var responseString = await client.GetStringAsync("https://profile.xboxlive.com/users/me/profile/settings?settings=Gamertag,Gamerscore");
                var Jsonresponse = (dynamic)(new JObject());
                Jsonresponse = (dynamic)JObject.Parse(responseString);
                LBL_Gamertag.Text = "Gamertag: " + Jsonresponse.profileUsers[0].settings[0].value;
                LBL_Gamerscore.Text = "Gamerscore: " + Jsonresponse.profileUsers[0].settings[1].value;
                LBL_XUID.Text = "XUID: " + Jsonresponse.profileUsers[0].id;
                xuid= Jsonresponse.profileUsers[0].id;
            }
            catch (HttpRequestException ex)
            {
                if ((int)ex.StatusCode == 401)
                    MessageBox.Show("Xauth is not correct. Restart this tool and kill xbox app services in task manager before reopening the xbox app", "401 Unauthorised");
                else
                    MessageBox.Show("something did a fucky wucky and I dont have a specific message for the error code", "fucky wucky");
            }


        }
        void testfunc(object sender, EventArgs e)
        {
            //Reference the Button which was clicked.
            Button button = (sender as Button);
            MessageBox.Show(button.Name.ToString());
        }
        private async void BTN_Recents_Click(object sender, EventArgs e)
        {
            client.DefaultRequestHeaders.Clear();
            client.DefaultRequestHeaders.Add("x-xbl-contract-version", "2");
            client.DefaultRequestHeaders.Add("Accept-Encoding", "gzip, deflate");
            client.DefaultRequestHeaders.Add("accept", "application/json");
            client.DefaultRequestHeaders.Add("accept-language", "en-GB");
            client.DefaultRequestHeaders.Add("Authorization", xauthtoken);
            client.DefaultRequestHeaders.Add("Host", "titlehub.xboxlive.com");
            client.DefaultRequestHeaders.Add("Connection", "Keep-Alive");
            try
            {
                var responseString = await client.GetStringAsync("https://titlehub.xboxlive.com/users/xuid(" + xuid + ")/titles/titleHistory/decoration/Achievement,scid");
                //var responseString = "{\"xuid\":\"2535418080192615\",\"titles\":[{\"titleId\":\"2030093255\",\"pfn\":\"Microsoft.624F8B84B80_8wekyb3d8bbwe\",\"bingId\":null,\"serviceConfigId\":\"00000000-0000-0000-0000-00007900c3c7\",\"windowsPhoneProductId\":null,\"name\":\"Forza Horizon 5\",\"type\":\"Game\",\"devices\":[\"PC\",\"XboxOne\",\"XboxSeries\"],\"displayImage\":\"http://store-images.s-microsoft.com/image/apps.28758.13734397844529069.202e3fc9-37d6-4853-a58b-fabe504b71e8.4335e940-f927-4be4-af08-8e689a17bd7a\",\"mediaItemType\":\"Application\",\"modernTitleId\":\"2030093255\",\"isBundle\":false,\"achievement\":{\"currentAchievements\":53,\"totalAchievements\":0,\"currentGamerscore\":1000,\"totalGamerscore\":1000,\"progressPercentage\":100.0,\"sourceVersion\":2},\"stats\":null,\"gamePass\":null,\"images\":null,\"titleHistory\":{\"lastTimePlayed\":\"2022-04-08T23:33:46.907689Z\",\"visible\":true,\"canHide\":false},\"titleRecord\":null,\"detail\":null,\"friendsWhoPlayed\":null,\"alternateTitleIds\":null,\"contentBoards\":null,\"xboxLiveTier\":\"Full\",\"isStreamable\":true},{\"titleId\":\"1289871275\",\"pfn\":\"Microsoft.OpusPG_8wekyb3d8bbwe\",\"bingId\":null,\"serviceConfigId\":\"19020100-9575-4c2b-9916-3d664ce1dfab\",\"windowsPhoneProductId\":null,\"name\":\"Forza Horizon 3\",\"type\":\"Game\",\"devices\":[\"PC\",\"XboxOne\",\"XboxSeries\"],\"displayImage\":\"http://store-images.s-microsoft.com/image/apps.64761.13510798886196618.50f5e180-67d1-476d-a4ef-174d6b220526.305ec856-672f-4db7-af88-3e5bade8c67d\",\"mediaItemType\":\"Application\",\"modernTitleId\":\"1289871275\",\"isBundle\":false,\"achievement\":{\"currentAchievements\":3,\"totalAchievements\":0,\"currentGamerscore\":40,\"totalGamerscore\":3000,\"progressPercentage\":1.0,\"sourceVersion\":2},\"stats\":null,\"gamePass\":null,\"images\":null,\"titleHistory\":{\"lastTimePlayed\":\"2022-04-06T03:07:16.219771Z\",\"visible\":true,\"canHide\":false},\"titleRecord\":null,\"detail\":null,\"friendsWhoPlayed\":null,\"alternateTitleIds\":null,\"contentBoards\":null,\"xboxLiveTier\":\"Full\"},{\"titleId\":\"1985701699\",\"pfn\":\"Microsoft.SunriseBaseGame_8wekyb3d8bbwe\",\"bingId\":null,\"serviceConfigId\":\"00000000-0000-0000-0000-0000765b6743\",\"windowsPhoneProductId\":null,\"name\":\"Forza Horizon 4\",\"type\":\"Game\",\"devices\":[\"PC\",\"XboxOne\",\"XboxSeries\"],\"displayImage\":\"http://store-images.s-microsoft.com/image/apps.55774.14339303838396367.e3a10a02-b1cd-411e-97aa-9dd8be1c992d.0fd9a9dc-9e16-4dcc-a5d9-b3ca90d23511\",\"mediaItemType\":\"Application\",\"modernTitleId\":\"1985701699\",\"isBundle\":false,\"achievement\":{\"currentAchievements\":154,\"totalAchievements\":0,\"currentGamerscore\":3100,\"totalGamerscore\":3610,\"progressPercentage\":86.0,\"sourceVersion\":2},\"stats\":null,\"gamePass\":null,\"images\":null,\"titleHistory\":{\"lastTimePlayed\":\"2022-04-04T19:08:43.8785011Z\",\"visible\":true,\"canHide\":false},\"titleRecord\":null,\"detail\":null,\"friendsWhoPlayed\":null,\"alternateTitleIds\":null,\"contentBoards\":null,\"xboxLiveTier\":\"Full\",\"isStreamable\":true},{\"titleId\":\"1144039928\",\"pfn\":\"Microsoft.Chelan_8wekyb3d8bbwe\",\"bingId\":\"f33009f4-14ff-4821-94e3-c3573c868c2e\",\"serviceConfigId\":\"77290100-225e-4768-9373-98164430a9f8\",\"windowsPhoneProductId\":null,\"name\":\"Halo: The Master Chief Collection\",\"type\":\"Game\",\"devices\":[\"PC\"],\"displayImage\":\"http://store-images.s-microsoft.com/image/apps.25919.14011015795942652.ca67db1b-d21e-47e9-bbb4-5ece2ce3f774.c71a2431-5ef1-4c32-92fa-22cca6162053\",\"mediaItemType\":\"Application\",\"modernTitleId\":\"1144039928\",\"isBundle\":false,\"achievement\":{\"currentAchievements\":0,\"totalAchievements\":0,\"currentGamerscore\":0,\"totalGamerscore\":7000,\"progressPercentage\":0.0,\"sourceVersion\":2},\"stats\":null,\"gamePass\":null,\"images\":null,\"titleHistory\":{\"lastTimePlayed\":\"2022-01-31T15:47:31.3042764Z\",\"visible\":true,\"canHide\":true},\"titleRecord\":null,\"detail\":null,\"friendsWhoPlayed\":null,\"alternateTitleIds\":null,\"contentBoards\":null,\"xboxLiveTier\":\"Full\",\"isStreamable\":true},{\"titleId\":\"2043073184\",\"pfn\":\"Microsoft.254428597CFE2_8wekyb3d8bbwe\",\"bingId\":null,\"serviceConfigId\":\"00000000-0000-0000-0000-000079c6d2a0\",\"windowsPhoneProductId\":null,\"name\":\"Halo Infinite\",\"type\":\"Game\",\"devices\":[\"PC\",\"XboxOne\",\"XboxSeries\"],\"displayImage\":\"http://store-images.s-microsoft.com/image/apps.21381.14330850369313893.ca028cc6-0250-4527-9563-95c2d95d43f8.e128ba6f-3ecf-444f-8750-b9b564ef9146\",\"mediaItemType\":\"Application\",\"modernTitleId\":\"2043073184\",\"isBundle\":false,\"achievement\":{\"currentAchievements\":16,\"totalAchievements\":0,\"currentGamerscore\":180,\"totalGamerscore\":1600,\"progressPercentage\":11.0,\"sourceVersion\":2},\"stats\":null,\"gamePass\":null,\"images\":null,\"titleHistory\":{\"lastTimePlayed\":\"2022-01-03T22:39:26.277215Z\",\"visible\":true,\"canHide\":false},\"titleRecord\":null,\"detail\":null,\"friendsWhoPlayed\":null,\"alternateTitleIds\":null,\"contentBoards\":null,\"xboxLiveTier\":\"Full\",\"isStreamable\":true},{\"titleId\":\"1794566092\",\"pfn\":\"Microsoft.4297127D64EC6_8wekyb3d8bbwe\",\"bingId\":null,\"serviceConfigId\":\"00000000-0000-0000-0000-00006af6e7cc\",\"windowsPhoneProductId\":null,\"name\":\"Minecraft Launcher\",\"type\":\"Game\",\"devices\":[\"PC\"],\"displayImage\":\"http://store-images.s-microsoft.com/image/apps.63471.14247769038588514.c32b7f8c-cb4d-4859-a2a8-4c02692f8838.3f807f20-cfcb-4a4a-aa27-32a9c7f72e9a\",\"mediaItemType\":\"Application\",\"modernTitleId\":\"1794566092\",\"isBundle\":false,\"achievement\":{\"currentAchievements\":0,\"totalAchievements\":0,\"currentGamerscore\":0,\"totalGamerscore\":0,\"progressPercentage\":0.0,\"sourceVersion\":0},\"stats\":null,\"gamePass\":null,\"images\":null,\"titleHistory\":{\"lastTimePlayed\":\"2021-12-19T10:07:13.2753586Z\",\"visible\":true,\"canHide\":true},\"titleRecord\":null,\"detail\":null,\"friendsWhoPlayed\":null,\"alternateTitleIds\":null,\"contentBoards\":null,\"xboxLiveTier\":\"Full\"},{\"titleId\":\"981972052\",\"pfn\":\"Microsoft.ApexPG_8wekyb3d8bbwe\",\"bingId\":\"f659e91d-3f0e-4065-bc65-36d8b73247ea\",\"serviceConfigId\":\"9bb50100-c0d7-4041-b98e-7e4a3a87b454\",\"windowsPhoneProductId\":null,\"name\":\"Forza Motorsport 6: Apex\",\"type\":\"Game\",\"devices\":[\"PC\"],\"displayImage\":\"http://store-images.s-microsoft.com/image/apps.40815.13510798884671594.3c01c20c-d1c4-4fe8-ac1d-8bf602583d17.97b35f28-e763-480c-ad70-8e9d6087dc73\",\"mediaItemType\":\"Application\",\"modernTitleId\":\"981972052\",\"isBundle\":false,\"achievement\":{\"currentAchievements\":0,\"totalAchievements\":0,\"currentGamerscore\":0,\"totalGamerscore\":1000,\"progressPercentage\":0.0,\"sourceVersion\":2},\"stats\":null,\"gamePass\":null,\"images\":null,\"titleHistory\":{\"lastTimePlayed\":\"2021-10-12T19:55:18.7760536Z\",\"visible\":true,\"canHide\":true},\"titleRecord\":null,\"detail\":null,\"friendsWhoPlayed\":null,\"alternateTitleIds\":null,\"contentBoards\":null,\"xboxLiveTier\":\"Full\"},{\"titleId\":\"1998214169\",\"pfn\":null,\"bingId\":null,\"serviceConfigId\":\"00000000-0000-0000-0000-0000771a5419\",\"windowsPhoneProductId\":null,\"name\":\"NieR: Automata\",\"type\":\"Game\",\"devices\":[\"Win32\"],\"displayImage\":\"http://images-eds.xboxlive.com/image?url=z951ykn43p4FqWbbFvR2Ec.8vbDhj8G2Xe7JngaTToBAInhxUS6pI0HjtmvshPyK9.Rgt7YgaJ0a_pt7aYIe3RwvYSpRNL0AAj7CHqwxIFouIWUr0ZvMyCS2zgQgM.F0JnQuen8aLrj0ycjUc46nMw--\",\"mediaItemType\":\"Application\",\"modernTitleId\":null,\"isBundle\":false,\"achievement\":{\"currentAchievements\":0,\"totalAchievements\":0,\"currentGamerscore\":0,\"totalGamerscore\":0,\"progressPercentage\":0.0,\"sourceVersion\":0},\"stats\":null,\"gamePass\":null,\"images\":null,\"titleHistory\":{\"lastTimePlayed\":\"2021-09-15T23:54:50.1971588Z\",\"visible\":true,\"canHide\":true},\"titleRecord\":null,\"detail\":null,\"friendsWhoPlayed\":null,\"alternateTitleIds\":null,\"contentBoards\":null,\"xboxLiveTier\":\"None\"},{\"titleId\":\"2058206598\",\"pfn\":null,\"bingId\":null,\"serviceConfigId\":\"00000000-0000-0000-0000-00007aadbd86\",\"windowsPhoneProductId\":null,\"name\":\"BeamNG.drive\",\"type\":\"Game\",\"devices\":[\"Win32\"],\"displayImage\":\"http://images-eds.xboxlive.com/image?url=z951ykn43p4FqWbbFvR2Ec.8vbDhj8G2Xe7JngaTToBAInhxUS6pI0HjtmvshPyKCB9H.r1.gCV8WQ05_ElVtHb9nWG.qGj3ohBHDmgFfcWBU.VOqYWWNxQGn4HxNrs2sWoJ8yDx1KcCnLTzWTIJug--\",\"mediaItemType\":\"Application\",\"modernTitleId\":null,\"isBundle\":false,\"achievement\":{\"currentAchievements\":0,\"totalAchievements\":0,\"currentGamerscore\":0,\"totalGamerscore\":0,\"progressPercentage\":0.0,\"sourceVersion\":0},\"stats\":null,\"gamePass\":null,\"images\":null,\"titleHistory\":{\"lastTimePlayed\":\"2021-09-09T20:51:27.3777107Z\",\"visible\":true,\"canHide\":true},\"titleRecord\":null,\"detail\":null,\"friendsWhoPlayed\":null,\"alternateTitleIds\":null,\"contentBoards\":null,\"xboxLiveTier\":\"None\"},{\"titleId\":\"1743959035\",\"pfn\":null,\"bingId\":null,\"serviceConfigId\":\"00000000-0000-0000-0000-000067f2b3fb\",\"windowsPhoneProductId\":null,\"name\":\"Car Mechanic Simulator 2021\",\"type\":\"Game\",\"devices\":[\"Win32\"],\"displayImage\":\"\",\"mediaItemType\":\"Application\",\"modernTitleId\":null,\"isBundle\":false,\"achievement\":{\"currentAchievements\":0,\"totalAchievements\":0,\"currentGamerscore\":0,\"totalGamerscore\":0,\"progressPercentage\":0.0,\"sourceVersion\":0},\"stats\":null,\"gamePass\":null,\"images\":null,\"titleHistory\":{\"lastTimePlayed\":\"2021-09-08T21:16:20.792712Z\",\"visible\":true,\"canHide\":true},\"titleRecord\":null,\"detail\":null,\"friendsWhoPlayed\":null,\"alternateTitleIds\":null,\"contentBoards\":null},{\"titleId\":\"1999574456\",\"pfn\":\"Microsoft.ApolloBaseGame_8wekyb3d8bbwe\",\"bingId\":null,\"serviceConfigId\":\"00000000-0000-0000-0000-0000772f15b8\",\"windowsPhoneProductId\":null,\"name\":\"Forza Motorsport 7\",\"type\":\"Game\",\"devices\":[\"PC\",\"XboxOne\",\"XboxSeries\"],\"displayImage\":\"http://store-images.s-microsoft.com/image/apps.56005.13510798887602644.6903d8ce-f3c0-4f96-b43b-d240124e1abb.dc1d28de-a589-4cb5-9313-f5ffd0f701ba\",\"mediaItemType\":\"Application\",\"modernTitleId\":\"1999574456\",\"isBundle\":false,\"achievement\":{\"currentAchievements\":19,\"totalAchievements\":0,\"currentGamerscore\":370,\"totalGamerscore\":1000,\"progressPercentage\":37.0,\"sourceVersion\":2},\"stats\":null,\"gamePass\":null,\"images\":null,\"titleHistory\":{\"lastTimePlayed\":\"2021-09-08T20:55:25.0925999Z\",\"visible\":true,\"canHide\":false},\"titleRecord\":null,\"detail\":null,\"friendsWhoPlayed\":null,\"alternateTitleIds\":null,\"contentBoards\":null,\"xboxLiveTier\":\"Full\"},{\"titleId\":\"1827948906\",\"pfn\":null,\"bingId\":null,\"serviceConfigId\":\"00000000-0000-0000-0000-00006cf4496a\",\"windowsPhoneProductId\":null,\"name\":\"The Long Dark\",\"type\":\"Game\",\"devices\":[\"Win32\"],\"displayImage\":\"http://images-eds.xboxlive.com/image?url=z951ykn43p4FqWbbFvR2Ec.8vbDhj8G2Xe7JngaTToBAInhxUS6pI0HjtmvshPyKJPOc52by.iTOqsg73zXU88hm3kEMwL8U7x3O1U3cVYATmCegAAJZq407JiS3Rine3go.g.mr3VD3c2rXL0R_3A--\",\"mediaItemType\":\"Application\",\"modernTitleId\":null,\"isBundle\":false,\"achievement\":{\"currentAchievements\":0,\"totalAchievements\":0,\"currentGamerscore\":0,\"totalGamerscore\":0,\"progressPercentage\":0.0,\"sourceVersion\":0},\"stats\":null,\"gamePass\":null,\"images\":null,\"titleHistory\":{\"lastTimePlayed\":\"2021-09-08T19:11:57.3853863Z\",\"visible\":true,\"canHide\":true},\"titleRecord\":null,\"detail\":null,\"friendsWhoPlayed\":null,\"alternateTitleIds\":null,\"contentBoards\":null,\"xboxLiveTier\":\"None\"},{\"titleId\":\"1664288261\",\"pfn\":null,\"bingId\":null,\"serviceConfigId\":\"00000000-0000-0000-0000-000063330605\",\"windowsPhoneProductId\":null,\"name\":\"Dying Light\",\"type\":\"Game\",\"devices\":[\"Win32\"],\"displayImage\":\"http://images-eds.xboxlive.com/image?url=z951ykn43p4FqWbbFvR2Ec.8vbDhj8G2Xe7JngaTToBAInhxUS6pI0HjtmvshPyKBDd29XwvB8IeLHBOGxr0XwpF8toLSrXguBLvIY_8khi_qPER_u86AQhh.dhT1ATccY2xPvGyQMu1GV9A4tau9A--\",\"mediaItemType\":\"Application\",\"modernTitleId\":null,\"isBundle\":false,\"achievement\":{\"currentAchievements\":0,\"totalAchievements\":0,\"currentGamerscore\":0,\"totalGamerscore\":0,\"progressPercentage\":0.0,\"sourceVersion\":0},\"stats\":null,\"gamePass\":null,\"images\":null,\"titleHistory\":{\"lastTimePlayed\":\"2021-08-27T21:48:42.5345748Z\",\"visible\":true,\"canHide\":true},\"titleRecord\":null,\"detail\":null,\"friendsWhoPlayed\":null,\"alternateTitleIds\":null,\"contentBoards\":null,\"xboxLiveTier\":\"None\"},{\"titleId\":\"1791712750\",\"pfn\":null,\"bingId\":null,\"serviceConfigId\":\"00000000-0000-0000-0000-00006acb5dee\",\"windowsPhoneProductId\":null,\"name\":\"Minecraft\",\"type\":\"Game\",\"devices\":[\"Win32\"],\"displayImage\":\"http://images-eds.xboxlive.com/image?url=z951ykn43p4FqWbbFvR2Ec.8vbDhj8G2Xe7JngaTToBAInhxUS6pI0HjtmvshPyKpwWTprHeUG2HfG4pmZEwqG1NSq4NmJCkpdYNX7I2_MYvy4fIYyoA7kDsiy8Nnpi3UH9MYzIxAGKCZkh5bM0Y4w--\",\"mediaItemType\":\"Application\",\"modernTitleId\":null,\"isBundle\":false,\"achievement\":{\"currentAchievements\":0,\"totalAchievements\":0,\"currentGamerscore\":0,\"totalGamerscore\":0,\"progressPercentage\":0.0,\"sourceVersion\":0},\"stats\":null,\"gamePass\":null,\"images\":null,\"titleHistory\":{\"lastTimePlayed\":\"2021-08-26T19:20:03.3384628Z\",\"visible\":true,\"canHide\":true},\"titleRecord\":null,\"detail\":null,\"friendsWhoPlayed\":null,\"alternateTitleIds\":null,\"contentBoards\":null,\"xboxLiveTier\":\"None\"},{\"titleId\":\"1745473085\",\"pfn\":null,\"bingId\":null,\"serviceConfigId\":\"00000000-0000-0000-0000-00006809ce3d\",\"windowsPhoneProductId\":null,\"name\":\"Portal 2\",\"type\":\"Game\",\"devices\":[\"Win32\"],\"displayImage\":\"http://images-eds.xboxlive.com/image?url=z951ykn43p4FqWbbFvR2Ec.8vbDhj8G2Xe7JngaTToBAInhxUS6pI0HjtmvshPyKttZ.fqjexI9GgUXr0cmES1fte0e8B27Q6Oi_twQ7lOPlWdU4P7AvwUwwFCmy9sEx2lUzGFs7Rl68f1kQV4vpUw--\",\"mediaItemType\":\"Application\",\"modernTitleId\":null,\"isBundle\":false,\"achievement\":{\"currentAchievements\":0,\"totalAchievements\":0,\"currentGamerscore\":0,\"totalGamerscore\":0,\"progressPercentage\":0.0,\"sourceVersion\":0},\"stats\":null,\"gamePass\":null,\"images\":null,\"titleHistory\":{\"lastTimePlayed\":\"2021-08-23T19:18:19.3394822Z\",\"visible\":true,\"canHide\":true},\"titleRecord\":null,\"detail\":null,\"friendsWhoPlayed\":null,\"alternateTitleIds\":null,\"contentBoards\":null,\"xboxLiveTier\":\"None\"},{\"titleId\":\"2096818168\",\"pfn\":\"Microsoft.OlympusPink_8wekyb3d8bbwe\",\"bingId\":null,\"serviceConfigId\":\"00000000-0000-0000-0000-00007cfae7f8\",\"windowsPhoneProductId\":null,\"name\":\"Halo Infinite - Insider\",\"type\":\"Game\",\"devices\":[\"XboxOne\",\"XboxSeries\"],\"displayImage\":\"http://store-images.s-microsoft.com/image/apps.65494.13731931399961873.0f3b3419-5de4-4f5b-9741-0259aa55d5fb.48577e2d-915b-4557-b5e0-14516e34a2a3\",\"mediaItemType\":\"Application\",\"modernTitleId\":\"2096818168\",\"isBundle\":false,\"achievement\":{\"currentAchievements\":0,\"totalAchievements\":0,\"currentGamerscore\":0,\"totalGamerscore\":0,\"progressPercentage\":0.0,\"sourceVersion\":0},\"stats\":null,\"gamePass\":null,\"images\":null,\"titleHistory\":{\"lastTimePlayed\":\"2021-07-31T22:36:14.2985238Z\",\"visible\":true,\"canHide\":true},\"titleRecord\":null,\"detail\":null,\"friendsWhoPlayed\":null,\"alternateTitleIds\":null,\"contentBoards\":null,\"xboxLiveTier\":\"Full\"},{\"titleId\":\"1862446374\",\"pfn\":null,\"bingId\":null,\"serviceConfigId\":\"00000000-0000-0000-0000-00006f02ad26\",\"windowsPhoneProductId\":null,\"name\":\"Grand Theft Auto V\",\"type\":\"Game\",\"devices\":[\"Win32\"],\"displayImage\":\"http://images-eds.xboxlive.com/image?url=z951ykn43p4FqWbbFvR2Ec.8vbDhj8G2Xe7JngaTToBAInhxUS6pI0HjtmvshPyK5m.5.LV9C5sd5zzXanznfsZZQC3lVWY4g.dT9bHyPbrVGfwxYEinVXitYDxSsHso7_ZOs1j8aCgo.7brfD3obw--\",\"mediaItemType\":\"Application\",\"modernTitleId\":null,\"isBundle\":false,\"achievement\":{\"currentAchievements\":0,\"totalAchievements\":0,\"currentGamerscore\":0,\"totalGamerscore\":0,\"progressPercentage\":0.0,\"sourceVersion\":0},\"stats\":null,\"gamePass\":null,\"images\":null,\"titleHistory\":{\"lastTimePlayed\":\"2021-04-05T20:21:59.7056784Z\",\"visible\":true,\"canHide\":true},\"titleRecord\":null,\"detail\":null,\"friendsWhoPlayed\":null,\"alternateTitleIds\":null,\"contentBoards\":null,\"xboxLiveTier\":\"None\"},{\"titleId\":\"1900078453\",\"pfn\":null,\"bingId\":null,\"serviceConfigId\":\"00000000-0000-0000-0000-00007140e575\",\"windowsPhoneProductId\":null,\"name\":\"7 Days to Die\",\"type\":\"Game\",\"devices\":[\"Win32\"],\"displayImage\":\"http://images-eds.xboxlive.com/image?url=z951ykn43p4FqWbbFvR2Ec.8vbDhj8G2Xe7JngaTToBAInhxUS6pI0HjtmvshPyKF1zMr9_l8CGL1RcNzN0TsrgGqxDRpzOzJpPfMBACfDkx8GkyeQqv6xCuePRvYBn9Gn7my_2ZyTDegeKMsuKTpg--\",\"mediaItemType\":\"Application\",\"modernTitleId\":null,\"isBundle\":false,\"achievement\":{\"currentAchievements\":0,\"totalAchievements\":0,\"currentGamerscore\":0,\"totalGamerscore\":0,\"progressPercentage\":0.0,\"sourceVersion\":0},\"stats\":null,\"gamePass\":null,\"images\":null,\"titleHistory\":{\"lastTimePlayed\":\"2021-04-05T18:39:18.8603268Z\",\"visible\":true,\"canHide\":true},\"titleRecord\":null,\"detail\":null,\"friendsWhoPlayed\":null,\"alternateTitleIds\":null,\"contentBoards\":null,\"xboxLiveTier\":\"None\"},{\"titleId\":\"1962957406\",\"pfn\":null,\"bingId\":null,\"serviceConfigId\":\"00000000-0000-0000-0000-000075005a5e\",\"windowsPhoneProductId\":null,\"name\":\"Genshin Impact\",\"type\":\"Game\",\"devices\":[\"Win32\"],\"displayImage\":\"http://images-eds.xboxlive.com/image?url=8Oaj9Ryq1G1_p3lLnXlsaZgGzAie6Mnu24_PawYuDYIoH77pJ.X5Z.MqQPibUVTcPnMMVV2S.gki47PXDl6PGMiDqHMBkiPNKo5reoVGkbvh5RTrDjJT9DxsqdHbKq8q73eTS_Xhxnkpm4bAitdLQw--\",\"mediaItemType\":\"Application\",\"modernTitleId\":null,\"isBundle\":false,\"achievement\":{\"currentAchievements\":0,\"totalAchievements\":0,\"currentGamerscore\":0,\"totalGamerscore\":0,\"progressPercentage\":0.0,\"sourceVersion\":0},\"stats\":null,\"gamePass\":null,\"images\":null,\"titleHistory\":{\"lastTimePlayed\":\"2021-03-22T20:20:41.7951068Z\",\"visible\":true,\"canHide\":true},\"titleRecord\":null,\"detail\":null,\"friendsWhoPlayed\":null,\"alternateTitleIds\":null,\"contentBoards\":null},{\"titleId\":\"1928525856\",\"pfn\":\"Microsoft.Cascade-Beta_8wekyb3d8bbwe\",\"bingId\":null,\"serviceConfigId\":\"00000000-0000-0000-0000-000072f2f820\",\"windowsPhoneProductId\":null,\"name\":\"Halo: MCC Insider\",\"type\":\"Game\",\"devices\":[\"PC\",\"XboxOne\",\"XboxSeries\"],\"displayImage\":\"http://store-images.s-microsoft.com/image/apps.58747.13817132297248492.f68e8e9b-16a9-4100-b440-caed7ae93cfa.bd7d94e1-1aeb-4716-9409-5d30bbcfd1fb\",\"mediaItemType\":\"Application\",\"modernTitleId\":\"1928525856\",\"isBundle\":false,\"achievement\":{\"currentAchievements\":0,\"totalAchievements\":0,\"currentGamerscore\":0,\"totalGamerscore\":0,\"progressPercentage\":0.0,\"sourceVersion\":0},\"stats\":null,\"gamePass\":null,\"images\":null,\"titleHistory\":{\"lastTimePlayed\":\"2020-10-21T15:42:50.4515305Z\",\"visible\":true,\"canHide\":true},\"titleRecord\":null,\"detail\":null,\"friendsWhoPlayed\":null,\"alternateTitleIds\":null,\"contentBoards\":null,\"xboxLiveTier\":\"Full\"},{\"titleId\":\"1619218235\",\"pfn\":null,\"bingId\":null,\"serviceConfigId\":\"00000000-0000-0000-0000-000060834f3b\",\"windowsPhoneProductId\":null,\"name\":\"Fall Guys: Ultimate Knockout\",\"type\":\"Game\",\"devices\":[\"Win32\"],\"displayImage\":\"http://images-eds.xboxlive.com/image?url=8Oaj9Ryq1G1_p3lLnXlsaZgGzAie6Mnu24_PawYuDYIoH77pJ.X5Z.MqQPibUVTcPnMMVV2S.gki47PXDl6PGGKpaXO2OT32zs8DA8tfnANfLTME_IOs5LA0hBIzWuMER11Zt1yjtB993tnGB_1XyA--\",\"mediaItemType\":\"Application\",\"modernTitleId\":null,\"isBundle\":false,\"achievement\":{\"currentAchievements\":0,\"totalAchievements\":0,\"currentGamerscore\":0,\"totalGamerscore\":0,\"progressPercentage\":0.0,\"sourceVersion\":0},\"stats\":null,\"gamePass\":null,\"images\":null,\"titleHistory\":{\"lastTimePlayed\":\"2020-09-29T14:01:15.381989Z\",\"visible\":true,\"canHide\":true},\"titleRecord\":null,\"detail\":null,\"friendsWhoPlayed\":null,\"alternateTitleIds\":null,\"contentBoards\":null},{\"titleId\":\"1793517378\",\"pfn\":null,\"bingId\":null,\"serviceConfigId\":\"00000000-0000-0000-0000-00006ae6e742\",\"windowsPhoneProductId\":null,\"name\":\"Horizon Zero Dawn\",\"type\":\"Game\",\"devices\":[\"Win32\"],\"displayImage\":\"http://images-eds.xboxlive.com/image?url=8Oaj9Ryq1G1_p3lLnXlsaZgGzAie6Mnu24_PawYuDYIoH77pJ.X5Z.MqQPibUVTcPnMMVV2S.gki47PXDl6PGHn98msprb0xRepwvDKG8.a4bRQCUk2yhGy0rnr9FxZ41psY2ePx3sAeqpxJ1SJITQ--\",\"mediaItemType\":\"Application\",\"modernTitleId\":null,\"isBundle\":false,\"achievement\":{\"currentAchievements\":0,\"totalAchievements\":0,\"currentGamerscore\":0,\"totalGamerscore\":0,\"progressPercentage\":0.0,\"sourceVersion\":0},\"stats\":null,\"gamePass\":null,\"images\":null,\"titleHistory\":{\"lastTimePlayed\":\"2020-09-06T20:47:29.3209197Z\",\"visible\":true,\"canHide\":true},\"titleRecord\":null,\"detail\":null,\"friendsWhoPlayed\":null,\"alternateTitleIds\":null,\"contentBoards\":null},{\"titleId\":\"1787008472\",\"pfn\":null,\"bingId\":null,\"serviceConfigId\":\"00000000-0000-0000-0000-00006a8395d8\",\"windowsPhoneProductId\":null,\"name\":\"Call of Duty: Modern Warfare\",\"type\":\"Game\",\"devices\":[\"Win32\"],\"displayImage\":\"http://images-eds.xboxlive.com/image?url=8Oaj9Ryq1G1_p3lLnXlsaZgGzAie6Mnu24_PawYuDYIoH77pJ.X5Z.MqQPibUVTcPnMMVV2S.gki47PXDl6PGE7.o.iHH1T3.LWWHilk7uIMvDIHzOHL6Y32nkuDe2XDEUDpkOgTw3vCujR7N_2JCg--\",\"mediaItemType\":\"Application\",\"modernTitleId\":null,\"isBundle\":false,\"achievement\":{\"currentAchievements\":0,\"totalAchievements\":0,\"currentGamerscore\":0,\"totalGamerscore\":0,\"progressPercentage\":0.0,\"sourceVersion\":0},\"stats\":null,\"gamePass\":null,\"images\":null,\"titleHistory\":{\"lastTimePlayed\":\"2020-09-06T01:46:01.8075418Z\",\"visible\":true,\"canHide\":true},\"titleRecord\":null,\"detail\":null,\"friendsWhoPlayed\":null,\"alternateTitleIds\":null,\"contentBoards\":null},{\"titleId\":\"1762047744\",\"pfn\":null,\"bingId\":null,\"serviceConfigId\":\"00000000-0000-0000-0000-00006906b700\",\"windowsPhoneProductId\":null,\"name\":\"Destiny 2\",\"type\":\"Game\",\"devices\":[\"Win32\"],\"displayImage\":\"http://images-eds.xboxlive.com/image?url=z951ykn43p4FqWbbFvR2Ec.8vbDhj8G2Xe7JngaTToBAInhxUS6pI0HjtmvshPyK5xB.ZeLifyx3D2vFT1oxasbUttswJAmzXkESt4HS_v0sUlq2GQ_QnsP6WyqCgMkjtSdJixzwRgfCurR2mdeyrg--\",\"mediaItemType\":\"Application\",\"modernTitleId\":null,\"isBundle\":false,\"achievement\":{\"currentAchievements\":0,\"totalAchievements\":0,\"currentGamerscore\":0,\"totalGamerscore\":0,\"progressPercentage\":0.0,\"sourceVersion\":0},\"stats\":null,\"gamePass\":null,\"images\":null,\"titleHistory\":{\"lastTimePlayed\":\"2020-09-04T00:07:50.541397Z\",\"visible\":true,\"canHide\":true},\"titleRecord\":null,\"detail\":null,\"friendsWhoPlayed\":null,\"alternateTitleIds\":null,\"contentBoards\":null,\"xboxLiveTier\":\"None\"},{\"titleId\":\"2081130223\",\"pfn\":null,\"bingId\":null,\"serviceConfigId\":\"00000000-0000-0000-0000-00007c0b86ef\",\"windowsPhoneProductId\":null,\"name\":\"Tom Clancy's Rainbow Six Siege\",\"type\":\"Game\",\"devices\":[\"Win32\"],\"displayImage\":\"http://images-eds.xboxlive.com/image?url=z951ykn43p4FqWbbFvR2Ec.8vbDhj8G2Xe7JngaTToBAInhxUS6pI0HjtmvshPyKI3WuG_oPpoNBsPh0M8Z7qo.MSLHWBRrJ7UV148dm1HY_a8YP8zbIchHfTdgiEhFuQU3IhYGkUPJMrbca6PK0Lw--\",\"mediaItemType\":\"Application\",\"modernTitleId\":null,\"isBundle\":false,\"achievement\":{\"currentAchievements\":0,\"totalAchievements\":0,\"currentGamerscore\":0,\"totalGamerscore\":0,\"progressPercentage\":0.0,\"sourceVersion\":0},\"stats\":null,\"gamePass\":null,\"images\":null,\"titleHistory\":{\"lastTimePlayed\":\"2020-09-01T23:18:14.1672683Z\",\"visible\":true,\"canHide\":true},\"titleRecord\":null,\"detail\":null,\"friendsWhoPlayed\":null,\"alternateTitleIds\":null,\"contentBoards\":null,\"xboxLiveTier\":\"None\"},{\"titleId\":\"1665186181\",\"pfn\":null,\"bingId\":null,\"serviceConfigId\":\"00000000-0000-0000-0000-00006340b985\",\"windowsPhoneProductId\":null,\"name\":\"Need for Speed: The Run\",\"type\":\"Game\",\"devices\":[\"Win32\"],\"displayImage\":\"http://images-eds.xboxlive.com/image?url=z951ykn43p4FqWbbFvR2Ec.8vbDhj8G2Xe7JngaTToBAInhxUS6pI0HjtmvshPyKQclNuwHgADHBb3jxQyJRRGfCcTecaIqgO068FgNr6dFROksILISM9XOptRIxEydVS0CO0mwE0F0ksa7_hB7u9g--\",\"mediaItemType\":\"Application\",\"modernTitleId\":null,\"isBundle\":false,\"achievement\":{\"currentAchievements\":0,\"totalAchievements\":0,\"currentGamerscore\":0,\"totalGamerscore\":0,\"progressPercentage\":0.0,\"sourceVersion\":0},\"stats\":null,\"gamePass\":null,\"images\":null,\"titleHistory\":{\"lastTimePlayed\":\"2020-09-01T21:11:36.5554221Z\",\"visible\":true,\"canHide\":true},\"titleRecord\":null,\"detail\":null,\"friendsWhoPlayed\":null,\"alternateTitleIds\":null,\"contentBoards\":null,\"xboxLiveTier\":\"None\"},{\"titleId\":\"1672769901\",\"pfn\":null,\"bingId\":null,\"serviceConfigId\":\"00000000-0000-0000-0000-000063b4716d\",\"windowsPhoneProductId\":null,\"name\":\"Call of Duty: Black Ops 3\",\"type\":\"Game\",\"devices\":[\"Win32\"],\"displayImage\":\"http://images-eds.xboxlive.com/image?url=z951ykn43p4FqWbbFvR2Ec.8vbDhj8G2Xe7JngaTToBAInhxUS6pI0HjtmvshPyKLWTdY2WajqghjBFhj0oJAC9a6_V_TczIdusirvzpGyXHXPtoZUp.Y0fFPOp2cUBYpzBEXIrWyjlvMvMa4s.YIw--\",\"mediaItemType\":\"Application\",\"modernTitleId\":null,\"isBundle\":false,\"achievement\":{\"currentAchievements\":0,\"totalAchievements\":0,\"currentGamerscore\":0,\"totalGamerscore\":0,\"progressPercentage\":0.0,\"sourceVersion\":0},\"stats\":null,\"gamePass\":null,\"images\":null,\"titleHistory\":{\"lastTimePlayed\":\"2020-08-26T12:24:45.6665432Z\",\"visible\":true,\"canHide\":true},\"titleRecord\":null,\"detail\":null,\"friendsWhoPlayed\":null,\"alternateTitleIds\":null,\"contentBoards\":null,\"xboxLiveTier\":\"None\"},{\"titleId\":\"1777860928\",\"pfn\":\"Microsoft.FlightSimulator_8wekyb3d8bbwe\",\"bingId\":null,\"serviceConfigId\":\"00000000-0000-0000-0000-000069f80140\",\"windowsPhoneProductId\":null,\"name\":\"Microsoft Flight Simulator\",\"type\":\"Game\",\"devices\":[\"PC\",\"XboxSeries\"],\"displayImage\":\"http://store-images.s-microsoft.com/image/apps.23563.14377492558798445.88bfc14d-d28c-473e-8db7-e23575b6843f.5b8d0765-c0c4-402b-9d97-28d3c5632790\",\"mediaItemType\":\"Application\",\"modernTitleId\":\"1777860928\",\"isBundle\":false,\"achievement\":{\"currentAchievements\":0,\"totalAchievements\":0,\"currentGamerscore\":0,\"totalGamerscore\":1000,\"progressPercentage\":0.0,\"sourceVersion\":2},\"stats\":null,\"gamePass\":null,\"images\":null,\"titleHistory\":{\"lastTimePlayed\":\"2020-08-18T23:46:46.859445Z\",\"visible\":true,\"canHide\":true},\"titleRecord\":null,\"detail\":null,\"friendsWhoPlayed\":null,\"alternateTitleIds\":null,\"contentBoards\":null,\"xboxLiveTier\":\"Full\",\"isStreamable\":true},{\"titleId\":\"1739375565\",\"pfn\":\"Microsoft.LovikaX1_8wekyb3d8bbwe\",\"bingId\":null,\"serviceConfigId\":\"00000000-0000-0000-0000-000067acc3cd\",\"windowsPhoneProductId\":null,\"name\":\"Minecraft Dungeons\",\"type\":\"Game\",\"devices\":[\"XboxOne\",\"XboxSeries\"],\"displayImage\":\"http://store-images.s-microsoft.com/image/apps.45275.14045794648370014.2229d39b-90c3-496e-8fac-9987450ca4d8.f422dee5-e9ee-4bfb-8f09-742de22ef8c2\",\"mediaItemType\":\"Application\",\"modernTitleId\":\"1739375565\",\"isBundle\":false,\"achievement\":{\"currentAchievements\":0,\"totalAchievements\":0,\"currentGamerscore\":0,\"totalGamerscore\":2470,\"progressPercentage\":0.0,\"sourceVersion\":2},\"stats\":null,\"gamePass\":null,\"images\":null,\"titleHistory\":{\"lastTimePlayed\":\"2020-05-27T12:25:15.8170472Z\",\"visible\":true,\"canHide\":true},\"titleRecord\":null,\"detail\":null,\"friendsWhoPlayed\":null,\"alternateTitleIds\":null,\"contentBoards\":null,\"xboxLiveTier\":\"Full\",\"isStreamable\":true},{\"titleId\":\"896928775\",\"pfn\":\"Microsoft.MinecraftUWP_8wekyb3d8bbwe\",\"bingId\":\"686834ad-c7a4-47f2-a66e-b0a0fc548c43\",\"serviceConfigId\":\"4fc10100-5f7a-4470-899b-280835760c07\",\"windowsPhoneProductId\":null,\"name\":\"Minecraft for Windows\",\"type\":\"Game\",\"devices\":[\"PC\"],\"displayImage\":\"http://store-images.s-microsoft.com/image/apps.51266.13510798885735219.99ab5ac6-beae-4db1-8438-9c2ee6e496b4.58b8bb52-fe3e-44d9-8f42-3fd7b6357e31\",\"mediaItemType\":\"Application\",\"modernTitleId\":\"896928775\",\"isBundle\":false,\"achievement\":{\"currentAchievements\":18,\"totalAchievements\":0,\"currentGamerscore\":310,\"totalGamerscore\":2760,\"progressPercentage\":11.0,\"sourceVersion\":2},\"stats\":null,\"gamePass\":null,\"images\":null,\"titleHistory\":{\"lastTimePlayed\":\"2020-05-21T19:03:10.3123605Z\",\"visible\":true,\"canHide\":false},\"titleRecord\":null,\"detail\":null,\"friendsWhoPlayed\":null,\"alternateTitleIds\":null,\"contentBoards\":null,\"xboxLiveTier\":\"Full\"},{\"titleId\":\"1732322725\",\"pfn\":null,\"bingId\":null,\"serviceConfigId\":\"00000000-0000-0000-0000-0000674125a5\",\"windowsPhoneProductId\":null,\"name\":\"Assetto Corsa\",\"type\":\"Game\",\"devices\":[\"Win32\"],\"displayImage\":\"http://images-eds.xboxlive.com/image?url=z951ykn43p4FqWbbFvR2Ec.8vbDhj8G2Xe7JngaTToBAInhxUS6pI0HjtmvshPyK_poJxeZqewqqm0Cm3BHJsrsb3OJZPREYb_p3pbZAsgSVxBedfWPtijjaMi8RZryKIWM76HFjUv6pWv.8IsVH1A--\",\"mediaItemType\":\"Application\",\"modernTitleId\":null,\"isBundle\":false,\"achievement\":{\"currentAchievements\":0,\"totalAchievements\":0,\"currentGamerscore\":0,\"totalGamerscore\":0,\"progressPercentage\":0.0,\"sourceVersion\":0},\"stats\":null,\"gamePass\":null,\"images\":null,\"titleHistory\":{\"lastTimePlayed\":\"2020-05-13T22:18:29.6680015Z\",\"visible\":true,\"canHide\":true},\"titleRecord\":null,\"detail\":null,\"friendsWhoPlayed\":null,\"alternateTitleIds\":null,\"contentBoards\":null,\"xboxLiveTier\":\"None\"},{\"titleId\":\"1856764962\",\"pfn\":null,\"bingId\":null,\"serviceConfigId\":\"00000000-0000-0000-0000-00006eabfc22\",\"windowsPhoneProductId\":null,\"name\":\"VALORANT\",\"type\":\"Game\",\"devices\":[\"Win32\"],\"displayImage\":\"http://images-eds.xboxlive.com/image?url=8Oaj9Ryq1G1_p3lLnXlsaZgGzAie6Mnu24_PawYuDYIoH77pJ.X5Z.MqQPibUVTcPnMMVV2S.gki47PXDl6PGBxbx99Uumk8tOTigRzJ8PxItfS0vDfKVsob1obqeFn..oTANkM8IAjMHKlRmeLM9Q--\",\"mediaItemType\":\"Application\",\"modernTitleId\":null,\"isBundle\":false,\"achievement\":{\"currentAchievements\":0,\"totalAchievements\":0,\"currentGamerscore\":0,\"totalGamerscore\":0,\"progressPercentage\":0.0,\"sourceVersion\":0},\"stats\":null,\"gamePass\":null,\"images\":null,\"titleHistory\":{\"lastTimePlayed\":\"2020-04-19T21:51:50.7629041Z\",\"visible\":true,\"canHide\":true},\"titleRecord\":null,\"detail\":null,\"friendsWhoPlayed\":null,\"alternateTitleIds\":null,\"contentBoards\":null},{\"titleId\":\"2140933132\",\"pfn\":null,\"bingId\":null,\"serviceConfigId\":\"00000000-0000-0000-0000-00007f9c0c0c\",\"windowsPhoneProductId\":null,\"name\":\"Rocket League\",\"type\":\"Game\",\"devices\":[\"Win32\"],\"displayImage\":\"http://images-eds.xboxlive.com/image?url=z951ykn43p4FqWbbFvR2Ec.8vbDhj8G2Xe7JngaTToBAInhxUS6pI0HjtmvshPyKDkVHrUDhZKzJcwW3NjVPQbsnBbwZuLVYoY1egdGD7FnY.LAuDXAbCtqf.eF5V7FSBfyJY9s_BvaIv178oPe9Rw--\",\"mediaItemType\":\"Application\",\"modernTitleId\":null,\"isBundle\":false,\"achievement\":{\"currentAchievements\":0,\"totalAchievements\":0,\"currentGamerscore\":0,\"totalGamerscore\":0,\"progressPercentage\":0.0,\"sourceVersion\":0},\"stats\":null,\"gamePass\":null,\"images\":null,\"titleHistory\":{\"lastTimePlayed\":\"2020-04-08T17:16:20.9120469Z\",\"visible\":true,\"canHide\":true},\"titleRecord\":null,\"detail\":null,\"friendsWhoPlayed\":null,\"alternateTitleIds\":null,\"contentBoards\":null,\"xboxLiveTier\":\"None\"},{\"titleId\":\"1930898112\",\"pfn\":null,\"bingId\":null,\"serviceConfigId\":\"00000000-0000-0000-0000-000073172ac0\",\"windowsPhoneProductId\":null,\"name\":\"Call of Duty: Black Ops 4\",\"type\":\"Game\",\"devices\":[\"Win32\"],\"displayImage\":\"http://images-eds.xboxlive.com/image?url=z951ykn43p4FqWbbFvR2Ec.8vbDhj8G2Xe7JngaTToBAInhxUS6pI0HjtmvshPyKKuePqb46x6b7f1Q_oXnYp4jo67TyWQVKq_StlEMSyl83Djy.86yAh7T557YNNTzBZNxYnkaQJYMnuTWYIhIGGw--\",\"mediaItemType\":\"Application\",\"modernTitleId\":null,\"isBundle\":false,\"achievement\":{\"currentAchievements\":0,\"totalAchievements\":0,\"currentGamerscore\":0,\"totalGamerscore\":0,\"progressPercentage\":0.0,\"sourceVersion\":0},\"stats\":null,\"gamePass\":null,\"images\":null,\"titleHistory\":{\"lastTimePlayed\":\"2020-03-15T23:38:23.6642508Z\",\"visible\":true,\"canHide\":true},\"titleRecord\":null,\"detail\":null,\"friendsWhoPlayed\":null,\"alternateTitleIds\":null,\"contentBoards\":null,\"xboxLiveTier\":\"None\"},{\"titleId\":\"1952593329\",\"pfn\":null,\"bingId\":null,\"serviceConfigId\":\"00000000-0000-0000-0000-0000746235b1\",\"windowsPhoneProductId\":null,\"name\":\"Hyperdimension Neptunia Re;Birth2: Sisters Generation\",\"type\":\"Game\",\"devices\":[\"Win32\"],\"displayImage\":\"http://images-eds.xboxlive.com/image?url=z951ykn43p4FqWbbFvR2Ec.8vbDhj8G2Xe7JngaTToBAInhxUS6pI0HjtmvshPyK2coCFH2E3CWtiE58ULTIz_teHYxvsp.e5CiRoduPZAaV796_XBmm4kZMgS0g2_DsxN8nk3k8Bptoq0zvVXcO.w--\",\"mediaItemType\":\"Application\",\"modernTitleId\":null,\"isBundle\":false,\"achievement\":{\"currentAchievements\":0,\"totalAchievements\":0,\"currentGamerscore\":0,\"totalGamerscore\":0,\"progressPercentage\":0.0,\"sourceVersion\":0},\"stats\":null,\"gamePass\":null,\"images\":null,\"titleHistory\":{\"lastTimePlayed\":\"2020-03-03T20:51:50.8074003Z\",\"visible\":true,\"canHide\":true},\"titleRecord\":null,\"detail\":null,\"friendsWhoPlayed\":null,\"alternateTitleIds\":null,\"contentBoards\":null,\"xboxLiveTier\":\"None\"},{\"titleId\":\"1957655552\",\"pfn\":null,\"bingId\":null,\"serviceConfigId\":\"00000000-0000-0000-0000-000074af7400\",\"windowsPhoneProductId\":null,\"name\":\"Need for Speed Heat\",\"type\":\"Game\",\"devices\":[\"Win32\"],\"displayImage\":\"http://images-eds.xboxlive.com/image?url=8Oaj9Ryq1G1_p3lLnXlsaZgGzAie6Mnu24_PawYuDYIoH77pJ.X5Z.MqQPibUVTcPnMMVV2S.gki47PXDl6PGPfo7N2BJTD0KwLP0lWneoiBNIuun0FVce64c20GBEjcdqoXIGszPTHfmW_uh3HJ4Q--\",\"mediaItemType\":\"Application\",\"modernTitleId\":null,\"isBundle\":false,\"achievement\":{\"currentAchievements\":0,\"totalAchievements\":0,\"currentGamerscore\":0,\"totalGamerscore\":0,\"progressPercentage\":0.0,\"sourceVersion\":0},\"stats\":null,\"gamePass\":null,\"images\":null,\"titleHistory\":{\"lastTimePlayed\":\"2020-03-03T14:28:44.8188836Z\",\"visible\":true,\"canHide\":true},\"titleRecord\":null,\"detail\":null,\"friendsWhoPlayed\":null,\"alternateTitleIds\":null,\"contentBoards\":null},{\"titleId\":\"1804382637\",\"pfn\":null,\"bingId\":null,\"serviceConfigId\":\"00000000-0000-0000-0000-00006b8cb1ad\",\"windowsPhoneProductId\":null,\"name\":\"SUPERHOT VR\",\"type\":\"Game\",\"devices\":[\"Win32\"],\"displayImage\":\"http://images-eds.xboxlive.com/image?url=z951ykn43p4FqWbbFvR2Ec.8vbDhj8G2Xe7JngaTToBAInhxUS6pI0HjtmvshPyKNGkillIxk3WCkJ2Oy.aZ9a3JbXCL7XZZl_4b5F5tf.hK2BV.jIr3VlV5VC4IvMrBihPJ_Pw0v_cRvehzkAZ.dA--\",\"mediaItemType\":\"Application\",\"modernTitleId\":null,\"isBundle\":false,\"achievement\":{\"currentAchievements\":0,\"totalAchievements\":0,\"currentGamerscore\":0,\"totalGamerscore\":0,\"progressPercentage\":0.0,\"sourceVersion\":0},\"stats\":null,\"gamePass\":null,\"images\":null,\"titleHistory\":{\"lastTimePlayed\":\"2020-03-02T20:23:21.2387681Z\",\"visible\":true,\"canHide\":true},\"titleRecord\":null,\"detail\":null,\"friendsWhoPlayed\":null,\"alternateTitleIds\":null,\"contentBoards\":null,\"xboxLiveTier\":\"None\"},{\"titleId\":\"2092578623\",\"pfn\":null,\"bingId\":null,\"serviceConfigId\":\"00000000-0000-0000-0000-00007cba373f\",\"windowsPhoneProductId\":null,\"name\":\"Star Wars Jedi: Fallen Order\",\"type\":\"Game\",\"devices\":[\"Win32\"],\"displayImage\":\"http://images-eds.xboxlive.com/image?url=8Oaj9Ryq1G1_p3lLnXlsaZgGzAie6Mnu24_PawYuDYIoH77pJ.X5Z.MqQPibUVTcPnMMVV2S.gki47PXDl6PGAe6NeEAF6FowGau_JDO_j052ChgWk..MFW5NizlOsToa2sUzbA1DSSS4Av.UIEx4g--\",\"mediaItemType\":\"Application\",\"modernTitleId\":null,\"isBundle\":false,\"achievement\":{\"currentAchievements\":0,\"totalAchievements\":0,\"currentGamerscore\":0,\"totalGamerscore\":0,\"progressPercentage\":0.0,\"sourceVersion\":0},\"stats\":null,\"gamePass\":null,\"images\":null,\"titleHistory\":{\"lastTimePlayed\":\"2019-11-23T22:26:01.1541416Z\",\"visible\":true,\"canHide\":true},\"titleRecord\":null,\"detail\":null,\"friendsWhoPlayed\":null,\"alternateTitleIds\":null,\"contentBoards\":null},{\"titleId\":\"2090060949\",\"pfn\":null,\"bingId\":null,\"serviceConfigId\":\"00000000-0000-0000-0000-00007c93cc95\",\"windowsPhoneProductId\":null,\"name\":\"Osu!\",\"type\":\"Game\",\"devices\":[\"Win32\"],\"displayImage\":\"http://images-eds.xboxlive.com/image?url=z951ykn43p4FqWbbFvR2Ec.8vbDhj8G2Xe7JngaTToBAInhxUS6pI0HjtmvshPyKM9AOhG4Wa7iyK_yTOustZteKzWMHI.O34Cmz.LPj3UDi04_xwCELDULo14SumKfH4H_I8IYEjIeB._kC9Hi4PA--\",\"mediaItemType\":\"Application\",\"modernTitleId\":null,\"isBundle\":false,\"achievement\":{\"currentAchievements\":0,\"totalAchievements\":0,\"currentGamerscore\":0,\"totalGamerscore\":0,\"progressPercentage\":0.0,\"sourceVersion\":0},\"stats\":null,\"gamePass\":null,\"images\":null,\"titleHistory\":{\"lastTimePlayed\":\"2019-11-10T01:03:44.8366107Z\",\"visible\":true,\"canHide\":true},\"titleRecord\":null,\"detail\":null,\"friendsWhoPlayed\":null,\"alternateTitleIds\":null,\"contentBoards\":null,\"xboxLiveTier\":\"None\"},{\"titleId\":\"1813451571\",\"pfn\":null,\"bingId\":null,\"serviceConfigId\":\"00000000-0000-0000-0000-00006c171333\",\"windowsPhoneProductId\":null,\"name\":\"The Forest\",\"type\":\"Game\",\"devices\":[\"Win32\"],\"displayImage\":\"http://images-eds.xboxlive.com/image?url=z951ykn43p4FqWbbFvR2Ec.8vbDhj8G2Xe7JngaTToBAInhxUS6pI0HjtmvshPyKIdL.9XiFeOLrd2D4slGzdtBdqUQfkiGoMfK38kUC9eXO8agoIR8JGtA3GfoTigY0QraFu0fHO1ktHTUCyM4r_g--\",\"mediaItemType\":\"Application\",\"modernTitleId\":null,\"isBundle\":false,\"achievement\":{\"currentAchievements\":0,\"totalAchievements\":0,\"currentGamerscore\":0,\"totalGamerscore\":0,\"progressPercentage\":0.0,\"sourceVersion\":0},\"stats\":null,\"gamePass\":null,\"images\":null,\"titleHistory\":{\"lastTimePlayed\":\"2019-10-30T14:26:16.2920855Z\",\"visible\":true,\"canHide\":true},\"titleRecord\":null,\"detail\":null,\"friendsWhoPlayed\":null,\"alternateTitleIds\":null,\"contentBoards\":null,\"xboxLiveTier\":\"None\"},{\"titleId\":\"1788842502\",\"pfn\":null,\"bingId\":null,\"serviceConfigId\":\"00000000-0000-0000-0000-00006a9f9206\",\"windowsPhoneProductId\":null,\"name\":\"GRID Autosport\",\"type\":\"Game\",\"devices\":[\"Win32\"],\"displayImage\":\"http://images-eds.xboxlive.com/image?url=z951ykn43p4FqWbbFvR2Ec.8vbDhj8G2Xe7JngaTToBAInhxUS6pI0HjtmvshPyKBB.KuR8RVaIhNGBVDo1npP86m8u0IAEQZi.Wci4zltNA.kgVpmpIe7L2qRFgd5oHA650Js.cJDeylCdtFI521Q--\",\"mediaItemType\":\"Application\",\"modernTitleId\":null,\"isBundle\":false,\"achievement\":{\"currentAchievements\":0,\"totalAchievements\":0,\"currentGamerscore\":0,\"totalGamerscore\":0,\"progressPercentage\":0.0,\"sourceVersion\":0},\"stats\":null,\"gamePass\":null,\"images\":null,\"titleHistory\":{\"lastTimePlayed\":\"2019-10-08T20:12:00.8075732Z\",\"visible\":true,\"canHide\":true},\"titleRecord\":null,\"detail\":null,\"friendsWhoPlayed\":null,\"alternateTitleIds\":null,\"contentBoards\":null,\"xboxLiveTier\":\"None\"},{\"titleId\":\"1702619408\",\"pfn\":null,\"bingId\":null,\"serviceConfigId\":\"00000000-0000-0000-0000-0000657be910\",\"windowsPhoneProductId\":null,\"name\":\"Call of Duty: Modern Warfare\",\"type\":\"Game\",\"devices\":[\"Win32\"],\"displayImage\":\"http://images-eds.xboxlive.com/image?url=8Oaj9Ryq1G1_p3lLnXlsaZgGzAie6Mnu24_PawYuDYIoH77pJ.X5Z.MqQPibUVTcPnMMVV2S.gki47PXDl6PGEfOf7tkAiDy0Q_tsEaaLIHqX4Qa2ZnfVzUBMaVp5pmu1saGYYBhxwKoodfbgWsP3w--\",\"mediaItemType\":\"Application\",\"modernTitleId\":null,\"isBundle\":false,\"achievement\":{\"currentAchievements\":0,\"totalAchievements\":0,\"currentGamerscore\":0,\"totalGamerscore\":0,\"progressPercentage\":0.0,\"sourceVersion\":0},\"stats\":null,\"gamePass\":null,\"images\":null,\"titleHistory\":{\"lastTimePlayed\":\"2019-09-21T18:43:26.6921646Z\",\"visible\":true,\"canHide\":true},\"titleRecord\":null,\"detail\":null,\"friendsWhoPlayed\":null,\"alternateTitleIds\":null,\"contentBoards\":null},{\"titleId\":\"1635723607\",\"pfn\":null,\"bingId\":null,\"serviceConfigId\":\"00000000-0000-0000-0000-0000617f2957\",\"windowsPhoneProductId\":null,\"name\":\"Overwatch\",\"type\":\"Game\",\"devices\":[\"Win32\"],\"displayImage\":\"http://images-eds.xboxlive.com/image?url=z951ykn43p4FqWbbFvR2Ec.8vbDhj8G2Xe7JngaTToBAInhxUS6pI0HjtmvshPyKdXirYFFxI_Ppjd8g5DK1M.2p8Dea5.WrF94jnQrkG_H7_B85ZMbcxKK3nUuhpC78gEcrPCgorXl3OSxm2Bm2tg--\",\"mediaItemType\":\"Application\",\"modernTitleId\":null,\"isBundle\":false,\"achievement\":{\"currentAchievements\":0,\"totalAchievements\":0,\"currentGamerscore\":0,\"totalGamerscore\":0,\"progressPercentage\":0.0,\"sourceVersion\":0},\"stats\":null,\"gamePass\":null,\"images\":null,\"titleHistory\":{\"lastTimePlayed\":\"2019-09-04T21:16:46.2266775Z\",\"visible\":true,\"canHide\":true},\"titleRecord\":null,\"detail\":null,\"friendsWhoPlayed\":null,\"alternateTitleIds\":null,\"contentBoards\":null,\"xboxLiveTier\":\"None\"},{\"titleId\":\"1714452188\",\"pfn\":null,\"bingId\":null,\"serviceConfigId\":\"00000000-0000-0000-0000-0000663076dc\",\"windowsPhoneProductId\":null,\"name\":\"Spellbreak\",\"type\":\"Game\",\"devices\":[\"Win32\"],\"displayImage\":\"http://images-eds.xboxlive.com/image?url=8Oaj9Ryq1G1_p3lLnXlsaZgGzAie6Mnu24_PawYuDYIoH77pJ.X5Z.MqQPibUVTcPnMMVV2S.gki47PXDl6PGIZ10mp_3dNdREth2LrWu8vh6a8fj.0jd.Nw8Id2XBGtMV0YjPLnY8wog46bDGr5hg--\",\"mediaItemType\":\"Application\",\"modernTitleId\":null,\"isBundle\":false,\"achievement\":{\"currentAchievements\":0,\"totalAchievements\":0,\"currentGamerscore\":0,\"totalGamerscore\":0,\"progressPercentage\":0.0,\"sourceVersion\":0},\"stats\":null,\"gamePass\":null,\"images\":null,\"titleHistory\":{\"lastTimePlayed\":\"2019-08-30T18:31:01.7470313Z\",\"visible\":true,\"canHide\":true},\"titleRecord\":null,\"detail\":null,\"friendsWhoPlayed\":null,\"alternateTitleIds\":null,\"contentBoards\":null},{\"titleId\":\"1841441354\",\"pfn\":null,\"bingId\":null,\"serviceConfigId\":\"00000000-0000-0000-0000-00006dc22a4a\",\"windowsPhoneProductId\":null,\"name\":\"Devil May Cry 5\",\"type\":\"Game\",\"devices\":[\"Win32\"],\"displayImage\":\"http://images-eds.xboxlive.com/image?url=8Oaj9Ryq1G1_p3lLnXlsaZgGzAie6Mnu24_PawYuDYIoH77pJ.X5Z.MqQPibUVTcPnMMVV2S.gki47PXDl6PGANDamGedslDhl3dymOslQFQWeTLwTle_E3cWv3MjH3wg6Sjnt6arx_u5aiDdCNDHw--\",\"mediaItemType\":\"Application\",\"modernTitleId\":null,\"isBundle\":false,\"achievement\":{\"currentAchievements\":0,\"totalAchievements\":0,\"currentGamerscore\":0,\"totalGamerscore\":0,\"progressPercentage\":0.0,\"sourceVersion\":0},\"stats\":null,\"gamePass\":null,\"images\":null,\"titleHistory\":{\"lastTimePlayed\":\"2019-07-03T22:16:39.4968275Z\",\"visible\":true,\"canHide\":true},\"titleRecord\":null,\"detail\":null,\"friendsWhoPlayed\":null,\"alternateTitleIds\":null,\"contentBoards\":null},{\"titleId\":\"1671550240\",\"pfn\":null,\"bingId\":null,\"serviceConfigId\":\"00000000-0000-0000-0000-000063a1d520\",\"windowsPhoneProductId\":null,\"name\":\"Need for Speed: Rivals\",\"type\":\"Game\",\"devices\":[\"Win32\"],\"displayImage\":\"http://images-eds.xboxlive.com/image?url=z951ykn43p4FqWbbFvR2Ec.8vbDhj8G2Xe7JngaTToBAInhxUS6pI0HjtmvshPyKJSZHo8WZs6FCQ9.rvAxv0CsBVdhyEeir1Hll1reziWshjbYHYNcXAX5AW.Qb_BnZCBVdQV.95upv4slKuKWpXg--\",\"mediaItemType\":\"Application\",\"modernTitleId\":null,\"isBundle\":false,\"achievement\":{\"currentAchievements\":0,\"totalAchievements\":0,\"currentGamerscore\":0,\"totalGamerscore\":0,\"progressPercentage\":0.0,\"sourceVersion\":0},\"stats\":null,\"gamePass\":null,\"images\":null,\"titleHistory\":{\"lastTimePlayed\":\"2019-06-11T23:34:32.2615967Z\",\"visible\":true,\"canHide\":true},\"titleRecord\":null,\"detail\":null,\"friendsWhoPlayed\":null,\"alternateTitleIds\":null,\"contentBoards\":null,\"xboxLiveTier\":\"None\"},{\"titleId\":\"1718312858\",\"pfn\":null,\"bingId\":null,\"serviceConfigId\":\"00000000-0000-0000-0000-0000666b5f9a\",\"windowsPhoneProductId\":null,\"name\":\"Black Squad\",\"type\":\"Game\",\"devices\":[\"Win32\"],\"displayImage\":\"http://images-eds.xboxlive.com/image?url=z951ykn43p4FqWbbFvR2Ec.8vbDhj8G2Xe7JngaTToBAInhxUS6pI0HjtmvshPyKPjpnO9NjfQ2hRZkGFrKxLndFX0fD1Vv.FsSMxtLtaNnkHiX0DCslDZMGYzoJjcpGIa3.YwFG63xiUh8Ngu7wSQ--\",\"mediaItemType\":\"Application\",\"modernTitleId\":null,\"isBundle\":false,\"achievement\":{\"currentAchievements\":0,\"totalAchievements\":0,\"currentGamerscore\":0,\"totalGamerscore\":0,\"progressPercentage\":0.0,\"sourceVersion\":0},\"stats\":null,\"gamePass\":null,\"images\":null,\"titleHistory\":{\"lastTimePlayed\":\"2019-06-07T23:15:48.7504668Z\",\"visible\":true,\"canHide\":true},\"titleRecord\":null,\"detail\":null,\"friendsWhoPlayed\":null,\"alternateTitleIds\":null,\"contentBoards\":null,\"xboxLiveTier\":\"None\"},{\"titleId\":\"1857101017\",\"pfn\":null,\"bingId\":null,\"serviceConfigId\":\"00000000-0000-0000-0000-00006eb11cd9\",\"windowsPhoneProductId\":null,\"name\":\"Anthem\",\"type\":\"Game\",\"devices\":[\"Win32\"],\"displayImage\":\"http://images-eds.xboxlive.com/image?url=8Oaj9Ryq1G1_p3lLnXlsaZgGzAie6Mnu24_PawYuDYIoH77pJ.X5Z.MqQPibUVTcPnMMVV2S.gki47PXDl6PGKpqlEvLDMI8KCISER6GPqMNzrWO_ZKxpKmXhwwZGD.8Mm62HQieTwAtMreG3eBPWQ--\",\"mediaItemType\":\"Application\",\"modernTitleId\":null,\"isBundle\":false,\"achievement\":{\"currentAchievements\":0,\"totalAchievements\":0,\"currentGamerscore\":0,\"totalGamerscore\":0,\"progressPercentage\":0.0,\"sourceVersion\":0},\"stats\":null,\"gamePass\":null,\"images\":null,\"titleHistory\":{\"lastTimePlayed\":\"2019-05-13T23:45:30.1748921Z\",\"visible\":true,\"canHide\":true},\"titleRecord\":null,\"detail\":null,\"friendsWhoPlayed\":null,\"alternateTitleIds\":null,\"contentBoards\":null}]}";
                var Jsonresponse = (dynamic)(new JObject());
                Jsonresponse = (dynamic)JObject.Parse(responseString);
                var count = 0;
                var newline = 0;
                for (int i = 0; i < Jsonresponse.titles.Count; i++)
                {
                    if (!(Jsonresponse.titles[i].devices.ToString()).Contains("Win32"))
                    {
                        if (i % 6 == 0 && i != 0)
                        {
                            newline = +160;
                            count = 0;
                        }
                        PictureBox GameImage = new PictureBox();
                        GameImage.Location = new System.Drawing.Point(130*count, 25+newline);
                        GameImage.Size = new System.Drawing.Size(125, 125);
                        GameImage.SizeMode = PictureBoxSizeMode.StretchImage;
                        GameImage.ImageLocation = Jsonresponse.titles[i].displayImage.ToString();
                        GameImage.Name = Jsonresponse.titles[i].titleId.ToString();
                        GameImage.Click += new System.EventHandler(this.LoadAchievementList);
                        Panel_Recents.Controls.Add(GameImage);
                        //Create the dynamic TextBox.
                        TextBox textbox = new TextBox();
                        textbox.Location = new System.Drawing.Point(130 * count, 150+newline);
                        textbox.Size = new System.Drawing.Size(125, 20);
                        textbox.Name = "txt_" + (count + 1);
                        textbox.Text = Jsonresponse.titles[i].name;
                        Panel_Recents.Controls.Add(textbox);
                        count = count + 1;

                        /*Create the dynamic Button to remove the TextBox.
                        Button button = new Button();
                        button.Location = new System.Drawing.Point(95, 25 * count);
                        button.Size = new System.Drawing.Size(60, 20);
                        button.Name = "btnDelete_" + (count + 1);
                        button.Text = "Delete";
                        button.Click += new System.EventHandler(this.testfunc);
                        Panel_Recents.Controls.Add(button);*/
                    }
                    if (Panel_Recents.Controls.OfType<TextBox>().ToList().Count == 12)
                        break;
                }
            }
            catch (HttpRequestException ex)
            {
                if ((int)ex.StatusCode == 401)
                    MessageBox.Show("Xauth is not correct. Restart this tool and kill xbox app services in task manager before reopening the xbox app", "401 Unauthorised");
                else
                    MessageBox.Show("something did a fucky wucky and I dont have a specific message for the error code", "fucky wucky");
            }
        }
        async void LoadAchievementList(object sender, EventArgs e)
        {
            PictureBox SelectedGame = (sender as PictureBox);

            client.DefaultRequestHeaders.Clear();
            client.DefaultRequestHeaders.Add("x-xbl-contract-version", "4");
            client.DefaultRequestHeaders.Add("Accept-Encoding", "gzip, deflate");
            client.DefaultRequestHeaders.Add("accept", "application/json");
            client.DefaultRequestHeaders.Add("accept-language", "en-GB");
            client.DefaultRequestHeaders.Add("Authorization", xauthtoken);
            client.DefaultRequestHeaders.Add("Host", "achievements.xboxlive.com");
            client.DefaultRequestHeaders.Add("Connection", "Keep-Alive");
            try
            {
                var responseString = await client.GetStringAsync("https://achievements.xboxlive.com/users/xuid(" + xuid + ")/achievements?titleId=" + SelectedGame.Name.ToString());
                var Jsonresponse = (dynamic)(new JObject());
                Jsonresponse = (dynamic)JObject.Parse(responseString);
                MessageBox.Show(Jsonresponse.ToString());
            }
            catch (HttpRequestException ex)
            {
                if ((int)ex.StatusCode == 401)
                    MessageBox.Show("Xauth is not correct. Restart this tool and kill xbox app services in task manager before reopening the xbox app", "401 Unauthorised");
                else
                    MessageBox.Show("something did a fucky wucky and I dont have a specific message for the error code", "fucky wucky");
            }


        }
    }
}
